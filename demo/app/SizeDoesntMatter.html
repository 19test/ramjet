<section>
	<h1>Size doesn't matter</h1>

	<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>

	<pre><code>ramjet.transform({{from}}, {{to}}, {
  easing: eases.{{easing}},
  duration: {{duration}}
});</code></pre>

	<div class='controls'>
		<select value='{{easing}}'>
			{{#each easingFunctions}}
				<option>{{this}}</option>
			{{/each}}
		</select>

		<label>
			<input type='range' value='{{duration}}' min='0' max='2000'>
			{{duration}}ms
		</label>
	</div>

	<div class='container'>
		{{#each items :i}}
			<div
				class='menu-item'
				data-id='{{id}}'
				style='background-color: {{color}};'
				on-tap='select(this)'
			>{{i+1}}</div>
		{{/each}}

		{{#with detail}}
			<div
				class='detail'
				intro-outro='ramjet:{target:"[data-id={{detail.id}}]"}'
			>
				{{title}}
			</div>
		{{/with}}
	</div>
</section>

<style>
	.controls {
		margin: 0 0 1em 0;
	}

	.container {
		width: 15rem;
	}

	.menu-item {
		font-size: 2em;
		width: 2rem;
		height: 2rem;
		padding: 1rem;
		text-align: center;
		line-height: 1;
		float: left;
		color: white;
		margin: 0 0.5em 0.5em 0;
		background-image: url(noise.png);
	}
</style>

<script>
	const ramjet = require( './ramjet' );
	const tap = require( 'ractive-events-tap' );
	const eases = require( 'eases' );

	component.exports = {
		data: () => ({
			easingFunctions: Object.keys( eases ),
			easing: 'cubicOut',
			duration: 400,
			reverse: false,

			items: [
				{
					color: '#001f3f',
					title: 'Triberg Falls, Black Forest, Germany',
					id: '3597623642_586c254584',
					url: 'https://www.flickr.com/photos/34419668@N08/3597623642'
				},
				{ color: '#0074D9' },
				{ color: '#7FDBFF' },
				{ color: '#39CCCC' },
				{ color: '#3D9970' },
				{ color: '#2ECC40' },
				{ color: '#01FF70' },
				{ color: '#FFDC00' },
				{ color: '#FF851B' },
				{ color: '#FF4136' },
				{ color: '#85144b' },
				{ color: '#B10DC9' }
			]
		}),

		computed: {
			from: '${reverse} ? "b" : "a"',
			to: '${reverse} ? "a" : "b"'
		},

		onrender: function () {
			const a = this.find( '.a' );
			const b = this.find( '.b' );

			this.on( 'start', () => {
				if ( this.get( 'transitioning' ) ) return;

				this.set( 'transitioning', true );

				const reverse = this.get( 'reverse' );

				const from = reverse ? b : a;
				const to = reverse ? a : b;

				from.classList.remove( 'hidden' );
				to.classList.remove( 'hidden' );

				ramjet.transform( from, to, {
					easing: eases[ this.get( 'easing' ) ],
					duration: this.get( 'duration' ),
					done: () => {
						this.set( 'transitioning', false );

						to.classList.remove( 'hidden' );
						this.toggle( 'reverse' );
					}
				});

				from.classList.add( 'hidden' );
				to.classList.add( 'hidden' );
			});
		},

		select ( item ) {
			if ( this.get( 'transitioning' ) ) return;

			this.set( 'transitioning', true );

			this.set( 'detail', null )
				.then( () => {
					console.log( 'setting detail', item );
					this.set({
						detail: item,
						transitioning: false
					});
				});
		},

		events: {
			tap
		},

		transitions: {
			ramjet ( t, params ) {
				console.log( 'params', params );
				t.complete();
			}
		}
	};
</script>